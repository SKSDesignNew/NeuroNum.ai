version: 1
frontend:
  phases:
    preBuild:
      commands:
        - echo "No build dependencies for static frontend"
    build:
      commands:
        - echo "Injecting environment config..."
        - |
          cat > js/env-config.js << ENVEOF
          window.__ENV__ = {
            COGNITO_DOMAIN:       '${COGNITO_DOMAIN}',
            COGNITO_CLIENT_ID:    '${COGNITO_CLIENT_ID}',
            COGNITO_REDIRECT_URI: '${COGNITO_REDIRECT_URI}',
            COGNITO_LOGOUT_URI:   '${COGNITO_LOGOUT_URI}',
            COGNITO_REGION:       '${COGNITO_REGION}',
            API_BASE:             '${API_BASE_URL}',
          };
          ENVEOF
        - echo "Build complete"
  artifacts:
    baseDirectory: /
    files:
      - index.html
      - auth.html
      - profile.html
      - dashboard.html
      - css/**/*
      - js/**/*
      - assets/**/*
  customHeaders:
    - pattern: '**/*'
      headers:
        - key: 'X-Frame-Options'
          value: 'DENY'
        - key: 'X-Content-Type-Options'
          value: 'nosniff'
        - key: 'Referrer-Policy'
          value: 'strict-origin-when-cross-origin'
  cache:
    paths: []
